# 네트워크 기초 - OSI 7계층



## 클라이언트/서버 모델

- 브라우저 -> 서버
- 서버 -> 서버



## osi 7계층

- 물리계층 
- 데이터링크 계층
- 네트워크 계층
- 전송계층
- 응용계층
  - 세션 계층
  - 표현 계층
  - 응용 계층



### 물리계층

- 전기 신호를 비트(0,1)로 바꾸거나 비트 신호를 전기 신호로 바꾸어 주는 계층
- 랜카드 : 컴퓨터에 랜선을 통하여 들어온 전기 신호를 비트 신호로 바꾸어 주는 역할을 한다. 

### 데이터링크 계층

- 기본적으로 데이터 구조는 '목적지 MAC주소 + 출발지 MAC주소 + 데이터 유형 ~~'프레임으로 되어 있다.  
  - MAC 주소 :  랜카드의 ID 
    - 한 자리당 4bit씩 12자리 -> 48bit
    - 4bit -> 16진수 표현
- 비트 신호를 (Ethernet)이더넷 이라는 프로토콜로 의미를 부여해줌 
- 스위치 : 연결된 컴퓨터의 MAC주소를 기억하고 연결할 라우터의 주소도 기억하는 장비
- 공유기 : 스위치의 역할을 무선으로 해주는 장비 

### 네트워크 계층

- IP : MAC주소들이 모여 있는 하나의 네트워크 주소

  - IPv4 : 32bit로 되어있는 IP주소
    - IPv4가 아직 고갈되지 않은 이유는 사설 IP때문임 => 내부 내트워크는 사설 IP를 이용
      - 사설 IP : 외부접속을 하는 IP가 아님 
        - 192.168.~~
          - 보통 192.168.0.0 or 1 은 그 사설 IP를 대표하는 주소임 ex) 공유기
          - 192.168.0.255 는 보통 브로드 캐스트 통신을 하는데 사설 네트워크에 연결된 모든 기기에 데이터를 전송하는 주소이다.
        - 10.~~
        - 172.16 ~ 172.31.~~
        - 특수 IP(Loopback)
          - 127.0.0.1 : localhost 내컴퓨터를 가리킴
      - 공인 IP : 다른 사람과 연결이 되는 IP
  - IPv6 :  기존의 IPv4의 주소가 거의 차서 사용하게 된 128bit의 주소 

  

  #### 네트워크 구조

  - ##### 네트워크 계층

    - 라우터들은 각 옆에 라우터의 주소(IP주소)를 알고 있고 연결이 되어있는 것을 인터넷 이라고 함 

      - 스위치들을 연결하여 네트워크를 구성하는 라우터(IP주소를 가짐)

        - ##### 데이터 링크 계층 

          - MAC주소를 가진 개인 PC들을 연결하는 스위치
            - MAC주소를 가진 개인 PC

  - 프레임 : 목적지 MAC + 출발지 MAC + 네트워크 데이터 + 트레일러
  - 네트워크 데이터(패킷) : 목적지 IP + 출발지 IP +  전송계층 데이터  
  - 통신시 바로 옆의 주소밖에 모르기 때문에 개인 MAC에서 스위치로 스위치에서 라우터로 라우터에서 옆 라우터로 하는 식으로 타고가서 원하는 주소를 찾아 통신을 하게 됨 

  ### 전송계층

  - 포트 : 어떠한 프로그램이 데이터를 처리해야 하는지 알려주는 번호(HTTP,HTTPS,SSH 등 프로그램은 응용 계층)
    - 80  : HTTP
    - 443 : HTTPS
    - 22 : SSH
    - 53 : DNS
    - 등등 0 ~ 65535 까지 있다 
    - 0 ~ 1023(Well Known Port) : 이미 다른 곳에서 쓰고 있을 수 있어서 직접 안 쓰는게 좋을 수 있다
      - 리눅스에서 해당 포트를 사용하려면 관리자 권한(sudo)이 필요하다
  - 오류 체크 
  - 전송계층 데이터(세그먼트) 
    - TCP 헤더 or UDP 헤더 
      - TCP : 프로토콜 중 하나로 데이터를 전송시 데이터를 검증하고 확인하는 과정이 있어 데이터 용량이 크고 느리다
      - UDP : 프로토콜 중 하나로 데이터를 전송시 데이터를 검증하지 않고 전송하여 빠른대신 유실이 있을 수 있다 
    - 데이터(세션계층 데이터)

### 응용 계층(세션 + 표현 + 응용 => HTTP)

- 응용 프로그램의 계층 
- HTTP Header + HTTP Body 로 구성 되어 있다 



### 총정리

데이터가 전송될 때 계층별로 부가적인 정보들이 붙게되고 (MAC주소, IP 주소, port ...) 받는 쪽에서는 계층을 지날 때 마다 하나씩 떨어지게 된다 

응용계층 -> 전송계층 -> 네트워크계층 -> 데이터링크 계층  

=> 목적지MAC+출발지MAC+목적지 IP+출발지IP+목적지PORT+출발지PORT+HTTP요청+트레일러

1. 목적지 MAC을 모르기 때문에 나의 라우터 MAC주소로 가게된다 -> 목적지MAC, 출발지MAC 제거
2. 나의 라우터에서 네이버(목적지)라우터의 MAC 주소를 알고있다 -> 목적지MAC을 네이버 라우터 MAC주소로 추가 ,출발지 MAC을 나의 라우터MAC으로 추가(IP포함)
3. 네이버 라우터로 이동 -> 목적지 MAC을 네이버 MAC으로 변경하고 출발지 MAC주소를 네이버 라우터 MAC주소로 바꾼다  
4. 네이버 서버 컴퓨터로 이동 -> 목적,출발 MAC, IP, PORT 사용 후 제거
5. HTTP요청 읽고 응답용 HTTP 메시지 작성 후 전달 (역순)

